(function(e){function t(t){for(var n,i,o=t[0],l=t[1],d=t[2],g=0,f=[];g<o.length;g++)i=o[g],Object.prototype.hasOwnProperty.call(a,i)&&a[i]&&f.push(a[i][0]),a[i]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(e[n]=l[n]);c&&c(t);while(f.length)f.shift()();return s.push.apply(s,d||[]),r()}function r(){for(var e,t=0;t<s.length;t++){for(var r=s[t],n=!0,o=1;o<r.length;o++){var l=r[o];0!==a[l]&&(n=!1)}n&&(s.splice(t--,1),e=i(i.s=r[0]))}return e}var n={},a={app:0},s=[];function i(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=e,i.c=n,i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(r,n,function(t){return e[t]}.bind(null,n));return r},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/gif-generator/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],l=o.push.bind(o);o.push=t,o=o.slice();for(var d=0;d<o.length;d++)t(o[d]);var c=l;s.push([0,"chunk-vendors"]),r()})({0:function(e,t,r){e.exports=r("56d7")},"034f":function(e,t,r){"use strict";var n=r("ecfe"),a=r.n(n);a.a},"56d7":function(e,t,r){"use strict";r.r(t);r("cadf"),r("551c"),r("f751"),r("097d");var n=r("2b0e"),a=r("7591"),s=r.n(a),i=r("a925"),o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"container justify-content-center",attrs:{id:"app"}},[e.renderedGifContents?e._e():n("div",{staticClass:"card-deck",attrs:{hidden:e.inProgress}},[n("div",{staticClass:"col-12 d-flex justify-content-center"},[n("GifType",{attrs:{text:e.text,"frame-rate":e.renderFrameRate,"background-image":r("62f6"),"generate-trigger":e.generateTrigger},on:{renderedImage:e.handleRenderedImage,progress:e.handleRenderingProgress}})],1),n("div",{staticClass:"col-12 d-flex justify-content-center pt-4"},[n("form",{staticClass:"col-8",on:{submit:function(t){return t.preventDefault(),e.handleSumbit(t)}}},[n("div",{staticClass:"form-group"},[n("label",{attrs:{for:"textMessage"}},[e._v(e._s(e.$t("message.message")))]),n("textarea",{directives:[{name:"model",rawName:"v-model",value:e.text,expression:"text"}],staticClass:"form-control col-12",attrs:{id:"textMessage"},domProps:{value:e.text},on:{input:function(t){t.target.composing||(e.text=t.target.value)}}})]),n("div",{staticClass:"form-group"},[n("label",{staticClass:"align-self-start",attrs:{for:"renderFrameRate"}},[e._v(e._s(e.$t("message.framerate")))]),n("input",{directives:[{name:"model",rawName:"v-model",value:e.renderFrameRate,expression:"renderFrameRate"}],staticClass:"form-control",attrs:{step:"0.1",id:"renderFrameRate",type:"number",min:"0.1",max:"100"},domProps:{value:e.renderFrameRate},on:{input:function(t){t.target.composing||(e.renderFrameRate=t.target.value)}}}),n("small",{staticClass:"form-text text-muted",attrs:{id:"emailHelp"}},[e._v(e._s(e.$t("message.frame_rate_help")))])]),n("div",{staticClass:"form-group"},[n("button",{staticClass:"form-control btn btn-primary"},[e._v(e._s(e.$t("message.generate_gif")))])])])])]),e.inProgress&&!e.renderedGifContents?n("div",{staticClass:"card-deck col-12 d-flex vh-100"},[n("div",{staticClass:"col-12 align-self-center"},[n("h1",[e._v("\n                "+e._s(e.$t("message.gif_generate_inp"))+"\n            ")]),n("div",{staticClass:"progress col-12 pl-0 pr-0"},[n("div",{staticClass:"progress-bar progress-bar-striped progress-bar-animated",style:"width:"+e.gifRenderProgress+"%;",attrs:{role:"progressbar"}},[e._v("\n                    "+e._s(e.gifRenderProgress)+"%\n                ")])])])]):e._e(),e.renderedGifContents?n("div",{staticClass:"card-deck"},[n("div",{staticClass:"col-12 d-flex justify-content-center"},[n("img",{staticClass:"mw-100",attrs:{src:e.renderedGifContents}})]),n("div",{staticClass:"col-12 d-flex justify-content-center pt-4"},[n("div",{staticClass:"form-group pr-2"},[n("button",{staticClass:"form-control btn btn-primary",on:{click:e.handleDownloadAction}},[e._v(e._s(e.$t("message.download_gif"))+"\n                ")])]),n("div",{staticClass:"form-group pl-2"},[n("button",{staticClass:"form-control btn btn-secondary",on:{click:e.handleNewGifRequest}},[e._v(e._s(e.$t("message.generate_new_gif"))+"\n                ")])])])]):e._e()])},l=[],d=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{ref:"stageParent"},[r("v-stage",{ref:"stage",attrs:{config:e.stageSize}},[r("v-layer",{ref:"image-layer"},[r("v-image",{attrs:{config:e.imageConfig}}),r("v-text",{attrs:{config:e.textConfig}})],1)],1)],1)},c=[],g=r("4209"),f=r.n(g),u=359,p=654,m=451,h=30,v={name:"GifType",props:["text","frameRate","backgroundImage","generateTrigger"],data:function(){return{stageSize:{width:p,height:m},textConfig:{text:"",x:18,y:105,wrap:"word",width:p-45,fontSize:h},imageConfig:{image:null,scaleX:null,scaleY:null},renderInterval:null,renderIntervalTime:1e3/this.frameRate,captureStarted:!1,gifRenderProgress:0,capturer:this.getCCapture()}},created:function(){var e=this,t=new window.Image;t.src=this.backgroundImage,t.onload=function(){var r=p/t.width;e.imageConfig.image=t,e.imageConfig.scaleX=r,e.imageConfig.scaleY=r}},mounted:function(){this.startRenderInterval()},methods:{getCCapture:function(){var e=this;return new f.a({framerate:this.frameRate,quality:100,workers:12,verbose:!1,format:"gif",workersPath:"js/",display:!1,onProgress:function(t){e.$emit("progress",100*t)}})},startRenderInterval:function(){var e=this,t=this;t.renderInterval=setInterval((function(){if(e.captureStarted){var r=e.$refs.stage.getStage().toCanvas();e.capturer.capture(r)}if(!t.text[t.textConfig.text.length])return clearInterval(t.renderInterval),void(t.captureStarted&&t.captureStopAndDownload());var n=t.text;e.gifRenderProgress=Math.round(t.textConfig.text.length/n.length*100),t.textConfig.text=t.textConfig.text+n[t.textConfig.text.length],t.textConfig.text.length>u&&(clearInterval(t.renderInterval),t.captureStarted&&t.captureStopAndDownload())}),this.renderIntervalTime)},redraw:function(){this.textConfig.text="",clearInterval(this.renderInterval),this.startRenderInterval()},generateResult:function(){this.renderIntervalTime=1,this.redraw(),this.captureStart()},captureStart:function(){this.captureStarted=!0,this.capturer.start()},captureStopAndDownload:function(){var e=this;this.capturer.stop(),this.capturer.save((function(t){e.$emit("renderedImage",t)})),this.renderIntervalTime=1e3/this.frameRate,this.captureStarted=!1,this.capturer=this.getCCapture()}},watch:{frameRate:function(e){this.renderIntervalTime=1e3/e,this.capturer=this.getCCapture(),this.redraw()},text:function(){this.redraw()},generateTrigger:function(){this.generateResult()}}},C=v,_=r("0c7c"),x=Object(_["a"])(C,d,c,!1,null,null,null),w=x.exports,b=r("7194"),y=r.n(b),I={name:"app",components:{GifType:w},data:function(){return{text:this.$t("message.welcome_text"),renderFrameRate:4,generateTrigger:null,renderedGifContents:null,renderedGifContentsBlob:null,inProgress:!1,gifRenderProgress:0}},methods:{handleNewGifRequest:function(){this.renderedGifContents=null,this.inProgress=!1,this.gifRenderProgress=0},handleRenderingProgress:function(e){this.gifRenderProgress=Math.round(e)},handleSumbit:function(){this.generateTrigger=Math.random(),this.inProgress=!0},handleRenderedImage:function(e){var t=this,r=new FileReader;this.renderedGifContentsBlob=e,r.readAsDataURL(e),r.onloadend=function(){t.renderedGifContents=r.result}},handleDownloadAction:function(){y()(this.renderedGifContentsBlob,"no-voice-message.gif","image/gif")}}},R=I,P=(r("034f"),Object(_["a"])(R,o,l,!1,null,null,null)),G=P.exports;n["default"].use(s.a),n["default"].use(i["a"]),n["default"].config.productionTip=!1;var S={en:{message:{welcome_text:"Hi, I don’t have any headphones, so I can’t listen that message, lol :)))",generate_new_gif:"Generate new GIF",download_gif:"Download GIF",gif_generate_inp:"You gif is generating, please wait.",generate_gif:"Generate GIF",frame_rate_help:"how many chars render peer second",framerate:"Framerate:",message:"Message:"}},ru:{message:{welcome_text:"Привет, у меня нет наушников, так что я не смогу прослушать такое сообщение, лол :)))",generate_new_gif:"Создать новый GIF",download_gif:"Скачать GIF",gif_generate_inp:"GIF файл генерируется, пожалуйста подождите.",generate_gif:"Создать GIF",frame_rate_help:"сколько символов отрисовывать в секунду",framerate:"Частота кадров:",message:"Сообщение:"}}},j=new i["a"]({locale:(navigator.language||navigator.userLanguage).substr(0,2),fallbackLocale:"en",messages:S});new n["default"]({i18n:j,render:function(e){return e(G)}}).$mount("#app")},"62f6":function(e,t,r){e.exports=r.p+"img/type-bg.ee0e9117.png"},ecfe:function(e,t,r){}});
//# sourceMappingURL=app.9d6aaee1.js.map